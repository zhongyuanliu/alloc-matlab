<!-- saved from url=(0014)about:internet -->
<div class="dead">
<pre class="code">
<span class="srcline"><span class="lineno"><a href="154,1" id="srcline1">  1</a></span><span class="line">function [x,flag]=QPACM(B,b,C,c,A,d,x0)</span></span>
<span class="srcline"><span class="lineno"><a href="154,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% min f(x)=1/2*x'*B*x - b'*x  %NB</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% C*x = c</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% A * x &lt;= d %NB</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,6" id="srcline6">  6</a></span><span class="line"><span class="comment">% assert (M_A &lt;= 1000);</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,7" id="srcline7">  7</a></span><span class="line">coder.varsize('W.A','W.d');<span class="comment">%!!!!!!!!!very important</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,8" id="srcline8">  8</a></span><span class="line">flag = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="154,9" id="srcline9">  9</a></span><span class="line">tol = 1e-8;</span></span>
<span class="srcline"><span class="lineno"><a href="154,10" id="srcline10"> 10</a></span><span class="line">x=x0;</span></span>
<span class="srcline"><span class="lineno"><a href="154,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">% W.A = A([1],:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">% W.d = d([1]);</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,13" id="srcline13"> 13</a></span><span class="line">W.A=zeros(0,size(A,2));<span class="comment">%empty</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,14" id="srcline14"> 14</a></span><span class="line">W.d=[];<span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">% [CW.A,IA] = setdiff(A,W.A,'rows','stable');%set1 - set2</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,16" id="srcline16"> 16</a></span><span class="line">CW.A = A;</span></span>
<span class="srcline"><span class="lineno"><a href="154,17" id="srcline17"> 17</a></span><span class="line">CW.d = d;</span></span>
<span class="srcline"><span class="lineno"><a href="154,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">% CW.d = d(IA);</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,19" id="srcline19"> 19</a></span><span class="line">m_C = size(C,1);</span></span>
<span class="srcline"><span class="lineno"><a href="154,20" id="srcline20"> 20</a></span><span class="line">max_iter = 200;</span></span>
<span class="srcline"><span class="lineno"><a href="154,21" id="srcline21"> 21</a></span><span class="line">i = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="154,22" id="srcline22"> 22</a></span><span class="line">while i&lt;max_iter</span></span>
<span class="srcline"><span class="lineno"><a href="154,23" id="srcline23"> 23</a></span><span class="line">    i = i + 1;</span></span>
<span class="srcline"><span class="lineno"><a href="154,24" id="srcline24"> 24</a></span><span class="line">    flag = i;</span></span>
<span class="srcline"><span class="lineno"><a href="154,25" id="srcline25"> 25</a></span><span class="line">    <span class="comment">% check_rank = (rank([C;W.A])==size([C;W.A],1));</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,26" id="srcline26"> 26</a></span><span class="line">    [ p,r] = null_space(B,B*x-b,[C;W.A],0*[c;W.d]);<span class="comment">%null space is better</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,27" id="srcline27"> 27</a></span><span class="line">    p = p .* (abs(p)&gt;tol);</span></span>
<span class="srcline"><span class="lineno"><a href="154,28" id="srcline28"> 28</a></span><span class="line">    r = r .* (abs(r)&gt;tol);</span></span>
<span class="srcline"><span class="lineno"><a href="154,29" id="srcline29"> 29</a></span><span class="line">    <span class="comment">% lambda = r(1:m_C);</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,30" id="srcline30"> 30</a></span><span class="line">    miu = r(m_C + 1:end);</span></span>
<span class="srcline"><span class="lineno"><a href="154,31" id="srcline31"> 31</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="154,32" id="srcline32"> 32</a></span><span class="line">    if sum(abs(p)) == 0</span></span>
<span class="srcline"><span class="lineno"><a href="154,33" id="srcline33"> 33</a></span><span class="line">        if min(miu)&gt;=0</span></span>
<span class="srcline"><span class="lineno"><a href="154,34" id="srcline34"> 34</a></span><span class="line">            flag=i;</span></span>
<span class="srcline"><span class="lineno"><a href="154,35" id="srcline35"> 35</a></span><span class="line">            break;</span></span>
<span class="srcline"><span class="lineno"><a href="154,36" id="srcline36"> 36</a></span><span class="line">        else</span></span>
<span class="srcline"><span class="lineno"><a href="154,37" id="srcline37"> 37</a></span><span class="line">            [~,I] = min(miu);</span></span>
<span class="srcline"><span class="lineno"><a href="154,38" id="srcline38"> 38</a></span><span class="line">            CW.A = [CW.A;W.A(I,:)];</span></span>
<span class="srcline"><span class="lineno"><a href="154,39" id="srcline39"> 39</a></span><span class="line">            CW.d = [CW.d;W.d(I)];</span></span>
<span class="srcline"><span class="lineno"><a href="154,40" id="srcline40"> 40</a></span><span class="line">            if (~isempty(W.A(I,:))) &amp;&amp; (~isempty(W.d(I)))</span></span>
<span class="srcline"><span class="lineno"><a href="154,41" id="srcline41"> 41</a></span><span class="line">                W.A(I,:) = [];<span class="comment">%delete constr</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,42" id="srcline42"> 42</a></span><span class="line">                W.d(I) = [];</span></span>
<span class="srcline"><span class="lineno"><a href="154,43" id="srcline43"> 43</a></span><span class="line">            end</span></span>
<span class="srcline"><span class="lineno"><a href="154,44" id="srcline44"> 44</a></span><span class="line">        end</span></span>
<span class="srcline"><span class="lineno"><a href="154,45" id="srcline45"> 45</a></span><span class="line">    else</span></span>
<span class="srcline"><span class="lineno"><a href="154,46" id="srcline46"> 46</a></span><span class="line">        temp = CW.A * p;</span></span>
<span class="srcline"><span class="lineno"><a href="154,47" id="srcline47"> 47</a></span><span class="line">        I = find(temp&lt;-tol);</span></span>
<span class="srcline"><span class="lineno"><a href="154,48" id="srcline48"> 48</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="154,49" id="srcline49"> 49</a></span><span class="line">        if isempty(I)</span></span>
<span class="srcline"><span class="lineno"><a href="154,50" id="srcline50"> 50</a></span><span class="line">            alpha = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="154,51" id="srcline51"> 51</a></span><span class="line">        else</span></span>
<span class="srcline"><span class="lineno"><a href="154,52" id="srcline52"> 52</a></span><span class="line">            [alpha,Imin_alpha] = min((CW.A(I,:) * x - CW.d(I))./(CW.A(I,:) * p));</span></span>
<span class="srcline"><span class="lineno"><a href="154,53" id="srcline53"> 53</a></span><span class="line">            [alpha] = min(1,alpha);</span></span>
<span class="srcline"><span class="lineno"><a href="154,54" id="srcline54"> 54</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="154,55" id="srcline55"> 55</a></span><span class="line">            if  alpha&lt;1    <span class="comment">%alpha&gt;0 &amp;&amp;</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,56" id="srcline56"> 56</a></span><span class="line">                <span class="comment">%         [~,Imin_alpha] = min((CW.A(I,:) * x - CW.d(I))./(CW.A(I,:) * p));</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,57" id="srcline57"> 57</a></span><span class="line">                W.A = [W.A;CW.A(I(Imin_alpha),:)];<span class="comment">%add constr</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,58" id="srcline58"> 58</a></span><span class="line">                W.d = [W.d;CW.d(I(Imin_alpha))];</span></span>
<span class="srcline"><span class="lineno"><a href="154,59" id="srcline59"> 59</a></span><span class="line">                CW.A(I(Imin_alpha),:) = [];<span class="comment">%delete</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,60" id="srcline60"> 60</a></span><span class="line">                CW.d(I(Imin_alpha)) = [];</span></span>
<span class="srcline"><span class="lineno"><a href="154,61" id="srcline61"> 61</a></span><span class="line">            end</span></span>
<span class="srcline"><span class="lineno"><a href="154,62" id="srcline62"> 62</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="154,63" id="srcline63"> 63</a></span><span class="line">        end</span></span>
<span class="srcline"><span class="lineno"><a href="154,64" id="srcline64"> 64</a></span><span class="line">        x = x -alpha * p;<span class="comment">%NB</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,65" id="srcline65"> 65</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="154,66" id="srcline66"> 66</a></span><span class="line">    end</span></span>
<span class="srcline"><span class="lineno"><a href="154,67" id="srcline67"> 67</a></span><span class="line">end</span></span>
<span class="srcline"><span class="lineno"><a href="154,68" id="srcline68"> 68</a></span><span class="line"><span class="comment">% 1/2*x'*B*x - b'*x;</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,69" id="srcline69"> 69</a></span><span class="line">end</span></span>
<span class="srcline"><span class="lineno"><a href="154,70" id="srcline70"> 70</a></span><span class="line">function [ x,lambda] = range_space(G,g,A,b)</span></span>
<span class="srcline"><span class="lineno"><a href="154,71" id="srcline71"> 71</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,72" id="srcline72"> 72</a></span><span class="line"><span class="comment">% RANGE SPACE sol v e s the e qual i ty constrained convex QP:</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,73" id="srcline73"> 73</a></span><span class="line"><span class="comment">% min 1/2*x'Gx+g ' x (G i s required to be postiv e</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,74" id="srcline74"> 74</a></span><span class="line"><span class="comment">% d e f i n i t e )</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,75" id="srcline75"> 75</a></span><span class="line"><span class="comment">% s . t . A x = b (A i s required to have f u l l column</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">% rank )</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,77" id="srcline77"> 77</a></span><span class="line"><span class="comment">% G*x +g +A*lambda</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,78" id="srcline78"> 78</a></span><span class="line"><span class="comment">% where the number of v a r i ab l e s i s n and the number of co nst r ain ts i s m.</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,79" id="srcline79"> 79</a></span><span class="line"><span class="comment">% The range space of the OP i s used to fi nd the so l ut i on .</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,80" id="srcline80"> 80</a></span><span class="line"><span class="comment">% Input parameters</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,81" id="srcline81"> 81</a></span><span class="line"><span class="comment">% L : i s the cholesky f a c t o r i z a t i o n of the Hessian matrix (</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,82" id="srcline82"> 82</a></span><span class="line"><span class="comment">% nxn ) of the QP.</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,83" id="srcline83"> 83</a></span><span class="line"><span class="comment">% A : i s the const rai nt matrix (nxm) : every column contains</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,84" id="srcline84"> 84</a></span><span class="line"><span class="comment">% a from the</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,85" id="srcline85"> 85</a></span><span class="line"><span class="comment">% e qua li ty : a ' x = b .</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,86" id="srcline86"> 86</a></span><span class="line"><span class="comment">% g : i s the gradient ( nx1 ) of the QP.</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,87" id="srcline87"> 87</a></span><span class="line"><span class="comment">% b : i s the ri ght hand si de of the co nst r ai nt s .</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,88" id="srcline88"> 88</a></span><span class="line"><span class="comment">% Output parameters</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,89" id="srcline89"> 89</a></span><span class="line"><span class="comment">% x : the sol u ti o n</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,90" id="srcline90"> 90</a></span><span class="line"><span class="comment">% lambda : the lagrangian m u l t i p l i e r s</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,91" id="srcline91"> 91</a></span><span class="line"><span class="comment">% Date : 19. July 2016.</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,92" id="srcline92"> 92</a></span><span class="line"><span class="comment">% Reference : Numerical Algorithms for Sequential Quadratic</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,93" id="srcline93"> 93</a></span><span class="line"><span class="comment">% Optimization,pange 10</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,94" id="srcline94"> 94</a></span><span class="line"><span class="comment">%  A = -A;</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,95" id="srcline95"> 95</a></span><span class="line">g=-g;</span></span>
<span class="srcline"><span class="lineno"><a href="154,96" id="srcline96"> 96</a></span><span class="line"><span class="comment">%  b = -b;</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,97" id="srcline97"> 97</a></span><span class="line">if isempty(A)</span></span>
<span class="srcline"><span class="lineno"><a href="154,98" id="srcline98"> 98</a></span><span class="line">    x = -G\g ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,99" id="srcline99"> 99</a></span><span class="line">    lambda = [];</span></span>
<span class="srcline"><span class="lineno"><a href="154,100" id="srcline100">100</a></span><span class="line">else</span></span>
<span class="srcline"><span class="lineno"><a href="154,101" id="srcline101">101</a></span><span class="line">    L =chol(G,'lower');<span class="comment">%L*L' = G</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,102" id="srcline102">102</a></span><span class="line">    K = (L)\A';</span></span>
<span class="srcline"><span class="lineno"><a href="154,103" id="srcline103">103</a></span><span class="line">    H = K'*K;</span></span>
<span class="srcline"><span class="lineno"><a href="154,104" id="srcline104">104</a></span><span class="line">    w = L\g ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,105" id="srcline105">105</a></span><span class="line">    z = b+K'*w;</span></span>
<span class="srcline"><span class="lineno"><a href="154,106" id="srcline106">106</a></span><span class="line">    M = chol (H,'lower');</span></span>
<span class="srcline"><span class="lineno"><a href="154,107" id="srcline107">107</a></span><span class="line">    q = M \ z ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,108" id="srcline108">108</a></span><span class="line">    lambda = M'\q;</span></span>
<span class="srcline"><span class="lineno"><a href="154,109" id="srcline109">109</a></span><span class="line">    r = K*lambda-w;</span></span>
<span class="srcline"><span class="lineno"><a href="154,110" id="srcline110">110</a></span><span class="line">    x = L'\r ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,111" id="srcline111">111</a></span><span class="line">    <span class="comment">%  lambda = -lambda;</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,112" id="srcline112">112</a></span><span class="line">end</span></span>
<span class="srcline"><span class="lineno"><a href="154,113" id="srcline113">113</a></span><span class="line">end</span></span>
</pre>
</div>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="154,114" id="srcline114">114</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="154,115" id="srcline115">115</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S52T1U507">x</span> , <span class="var type1" id="S53T28U508">u</span> ]= null_space(<span class="var type1" id="S54T28U511">G</span>,<span class="var type1" id="S55T1U512">g</span>,<span class="var type1" id="S56T28U513">A</span>,<span class="var type1" id="S57T28U514">b</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="154,116" id="srcline116">116</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,117" id="srcline117">117</a></span><span class="line"><span class="comment">% NULL SPACE sol v e s the eq ual i ty constrained convex QP:</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,118" id="srcline118">118</a></span><span class="line"><span class="comment">% min 1/2x 'Gx+g ' x (G i s required to be postiv e semi</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,119" id="srcline119">119</a></span><span class="line"><span class="comment">% d e f i n i t e )</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,120" id="srcline120">120</a></span><span class="line"><span class="comment">% s . t . A' x = b (A i s required to have f u l l column</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,121" id="srcline121">121</a></span><span class="line"><span class="comment">% rank )</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,122" id="srcline122">122</a></span><span class="line"><span class="comment">% where the number of v a ri a b l es i s n and the number of c o nst ra int s i s m.</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,123" id="srcline123">123</a></span><span class="line"><span class="comment">% The nul l space of the OP i s used to fi nd the so l ut io n .</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,124" id="srcline124">124</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,125" id="srcline125">125</a></span><span class="line"><span class="comment">% Call</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,126" id="srcline126">126</a></span><span class="line"><span class="comment">% [ x , u ] = n ul l sp ac e (G,A, g , b)</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,127" id="srcline127">127</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,128" id="srcline128">128</a></span><span class="line"><span class="comment">% Input parameters</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,129" id="srcline129">129</a></span><span class="line"><span class="comment">% G : i s the Hessian matrix (nxn ) of the QP.</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,130" id="srcline130">130</a></span><span class="line"><span class="comment">% A : i s the c onstr ai nt matrix (nxm) : every column contains</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,131" id="srcline131">131</a></span><span class="line"><span class="comment">% a from the</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,132" id="srcline132">132</a></span><span class="line"><span class="comment">% e qual i ty : a ' x = b .</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,133" id="srcline133">133</a></span><span class="line"><span class="comment">% g : i s the gradient (nx1 ) of the QP.</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,134" id="srcline134">134</a></span><span class="line"><span class="comment">% b : i s the r i ght hand si de of the c o nst ra i nt s .</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,135" id="srcline135">135</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,136" id="srcline136">136</a></span><span class="line"><span class="comment">% Output parameters</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,137" id="srcline137">137</a></span><span class="line"><span class="comment">% x : the sol u ti o n</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,138" id="srcline138">138</a></span><span class="line"><span class="comment">% mu : the lagrangian m u l t i p l i e r s</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,139" id="srcline139">139</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,140" id="srcline140">140</a></span><span class="line"><span class="comment">% By : Carsten V\ ¨olcker , s961572 &amp; Esben Lundsager Hansen , s022022 .</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,141" id="srcline141">141</a></span><span class="line"><span class="comment">% Subject : Numerical Methods f or Sequential Quadratic Optimization ,</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,142" id="srcline142">142</a></span><span class="line"><span class="comment">% Master Thesis , IMM, DTU, DK-2800 Lyngby .</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,143" id="srcline143">143</a></span><span class="line"><span class="comment">% Supervisor : John Bagterp Jørgensen , Assistant Pr ofe ssor &amp; Per Grove</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,144" id="srcline144">144</a></span><span class="line"><span class="comment">% Thomsen , Professor .</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,145" id="srcline145">145</a></span><span class="line"><span class="comment">% Date : 08. february 2007.</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,146" id="srcline146">146</a></span><span class="line"><span class="mxinfo " id="T1:U7"><span class="var type1" id="S55T1U517">g</span>=<span class="mxinfo " id="T1:U9">-<span class="var type1" id="S55T1U519">g</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="154,147" id="srcline147">147</a></span><span class="line"><span class="mxinfo " id="T28:U11"><span class="var type1" id="S56T28U522">A</span>=<span class="mxinfo " id="T28:U13"><span class="var type1" id="S56T28U524">A</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="154,148" id="srcline148">148</a></span><span class="line"><span class="mxinfo " id="T3:U15">[ <span class="var type1" id="S58T3U528">n</span> ,<span class="var type1" id="S59T3U529">m</span>] = size (<span class="var type1" id="S56T28U532">A</span>)</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,149" id="srcline149">149</a></span><span class="line"><span class="keyword">if</span> ( <span class="mxinfo " id="T7:U19"><span class="var type1" id="S59T3U537">m</span>~=<span class="mxinfo " id="T3:U21">0</span></span> ) <span class="comment">% for si t u a t i o ns where A i s empty</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,150" id="srcline150">150</a></span><span class="line">    [<span class="var type1" id="S61T28U542">Q</span>,<span class="var type1" id="S62T28U543">R</span>] = qr (<span class="var type1" id="S56T28U546">A</span>) ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,151" id="srcline151">151</a></span><span class="line">    <span class="mxinfo " id="T28:U25"><span class="var type1" id="S64T28U549">Q1</span> = <span class="mxinfo " id="T28:U27"><span class="var type1" id="S61T28U551">Q</span>( <span class="mxinfo " id="T41:U29">:</span> , <span class="mxinfo " id="T32:U30"><span class="mxinfo " id="T3:U31">1</span> :<span class="var type1" id="S59T3U555">m</span></span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,152" id="srcline152">152</a></span><span class="line">    <span class="mxinfo " id="T28:U33"><span class="var type1" id="S65T28U558">Q2</span> = <span class="mxinfo " id="T28:U35"><span class="var type1" id="S61T28U560">Q</span>( <span class="mxinfo " id="T41:U37">:</span> ,<span class="mxinfo " id="T32:U38"><span class="mxinfo " id="T3:U39"><span class="var type1" id="S59T3U564">m</span>+<span class="mxinfo " id="T3:U41">1</span></span>:<span class="var type1" id="S58T3U566">n</span></span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,153" id="srcline153">153</a></span><span class="line">    <span class="mxinfo " id="T28:U43"><span class="var type1" id="S62T28U569">R</span> = <span class="mxinfo " id="T28:U45"><span class="var type1" id="S62T28U571">R</span>( <span class="mxinfo " id="T32:U47"><span class="mxinfo " id="T3:U48">1</span>:<span class="var type1" id="S59T3U574">m</span></span>, <span class="mxinfo " id="T41:U50">:</span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,154" id="srcline154">154</a></span><span class="line">    <span class="mxinfo " id="T28:U51"><span class="var type1" id="S66T28U578">py</span> = <span class="mxinfo " id="T28:U53"><span class="mxinfo " id="T28:U54"><span class="var type1" id="S62T28U581">R</span>'</span>\<span class="var type1" id="S57T28U582">b</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,155" id="srcline155">155</a></span><span class="line">    <span class="mxinfo " id="T28:U57"><span class="var type1" id="S67T28U585">Q2t</span> = <span class="mxinfo " id="T28:U59"><span class="var type1" id="S65T28U587">Q2</span>'</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,156" id="srcline156">156</a></span><span class="line">    <span class="mxinfo " id="T1:U61"><span class="var type1" id="S68T1U590">gz</span> = <span class="mxinfo " id="T1:U63"><span class="var type1" id="S67T28U592">Q2t</span>*(<span class="mxinfo " id="T1:U65"><span class="mxinfo " id="T28:U66"><span class="var type1" id="S54T28U596">G</span>*(<span class="mxinfo " id="T28:U68"><span class="var type1" id="S64T28U599">Q1</span>*<span class="var type1" id="S66T28U600">py</span></span> )</span> + <span class="var type1" id="S55T1U601">g</span></span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,157" id="srcline157">157</a></span><span class="line">    <span class="mxinfo " id="T28:U72"><span class="var type1" id="S69T28U604">Gz</span> = <span class="mxinfo " id="T28:U74"><span class="mxinfo " id="T28:U75"><span class="var type1" id="S67T28U607">Q2t</span>*<span class="var type1" id="S54T28U608">G</span></span>*<span class="var type1" id="S65T28U609">Q2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="154,158" id="srcline158">158</a></span><span class="line">    <span class="mxinfo " id="T28:U79"><span class="var type1" id="S70T28U612">L</span> = <span class="mxinfo " id="T28:U81"><span class="mxinfo " id="T28:U82">chol(<span class="var type1" id="S69T28U616">Gz</span>)</span>'</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,159" id="srcline159">159</a></span><span class="line">    <span class="mxinfo " id="T1:U84"><span class="var type1" id="S72T1U619">pz</span> = <span class="mxinfo " id="T1:U86"><span class="var type1" id="S70T28U621">L</span>\<span class="mxinfo " id="T1:U88">-<span class="var type1" id="S68T1U623">gz</span></span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,160" id="srcline160">160</a></span><span class="line">    <span class="mxinfo " id="T1:U90"><span class="var type1" id="S72T1U626">pz</span> = <span class="mxinfo " id="T1:U92"><span class="mxinfo " id="T28:U93"><span class="var type1" id="S70T28U629">L</span>'</span>\ <span class="var type1" id="S72T1U630">pz</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,161" id="srcline161">161</a></span><span class="line">    <span class="mxinfo " id="T1:U96"><span class="var type1" id="S52T1U633">x</span> = <span class="mxinfo " id="T1:U98"><span class="mxinfo " id="T28:U99"><span class="var type1" id="S64T28U636">Q1</span>*<span class="var type1" id="S66T28U637">py</span></span> + <span class="mxinfo " id="T1:U102"><span class="var type1" id="S65T28U639">Q2</span>*<span class="var type1" id="S72T1U640">pz</span></span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,162" id="srcline162">162</a></span><span class="line">    <span class="mxinfo " id="T28:U105"><span class="var type1" id="S53T28U643">u</span> = <span class="mxinfo " id="T1:U107"><span class="var type1" id="S62T28U645">R</span>\(<span class="mxinfo " id="T1:U109"><span class="mxinfo " id="T28:U110"><span class="var type1" id="S64T28U649">Q1</span>'</span> * (<span class="mxinfo " id="T1:U112"><span class="mxinfo " id="T1:U113"><span class="var type1" id="S54T28U653">G</span>*<span class="var type1" id="S52T1U654">x</span></span> + <span class="var type1" id="S55T1U655">g</span></span> )</span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,163" id="srcline163">163</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,164" id="srcline164">164</a></span><span class="line">    <span class="mxinfo " id="T1:U117"><span class="var type1" id="S52T1U659">x</span> = <span class="mxinfo " id="T1:U119"><span class="mxinfo " id="T28:U120">-<span class="var type1" id="S54T28U662">G</span></span>\<span class="var type1" id="S55T1U663">g</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,165" id="srcline165">165</a></span><span class="line">    <span class="mxinfo " id="T28:U123"><span class="var type1" id="S53T28U666">u</span> = <span class="mxinfo " id="T57:U125">[ ]</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="154,166" id="srcline166">166</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="154,167" id="srcline167">167</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
