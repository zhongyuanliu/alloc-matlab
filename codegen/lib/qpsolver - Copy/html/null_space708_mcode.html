<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="147,111" id="srcline111">111</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="147,112" id="srcline112">112</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S52T1U507">x</span> , <span class="var type1" id="S53T18U508">u</span> ]= null_space(<span class="var type1" id="S54T18U511">G</span>,<span class="var type1" id="S55T1U512">g</span>,<span class="var type1" id="S56T18U513">A</span>,<span class="var type1" id="S57T18U514">b</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="147,113" id="srcline113">113</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,114" id="srcline114">114</a></span><span class="line"><span class="comment">% NULL SPACE sol v e s the eq ual i ty constrained convex QP:</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,115" id="srcline115">115</a></span><span class="line"><span class="comment">% min 1/2x 'Gx+g ' x (G i s required to be postiv e semi</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,116" id="srcline116">116</a></span><span class="line"><span class="comment">% d e f i n i t e )</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,117" id="srcline117">117</a></span><span class="line"><span class="comment">% s . t . A' x = b (A i s required to have f u l l column</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,118" id="srcline118">118</a></span><span class="line"><span class="comment">% rank )</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,119" id="srcline119">119</a></span><span class="line"><span class="comment">% where the number of v a ri a b l es i s n and the number of c o nst ra int s i s m.</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,120" id="srcline120">120</a></span><span class="line"><span class="comment">% The nul l space of the OP i s used to fi nd the so l ut io n .</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,121" id="srcline121">121</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,122" id="srcline122">122</a></span><span class="line"><span class="comment">% Call</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,123" id="srcline123">123</a></span><span class="line"><span class="comment">% [ x , u ] = n ul l sp ac e (G,A, g , b)</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,124" id="srcline124">124</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,125" id="srcline125">125</a></span><span class="line"><span class="comment">% Input parameters</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,126" id="srcline126">126</a></span><span class="line"><span class="comment">% G : i s the Hessian matrix (nxn ) of the QP.</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,127" id="srcline127">127</a></span><span class="line"><span class="comment">% A : i s the c onstr ai nt matrix (nxm) : every column contains</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,128" id="srcline128">128</a></span><span class="line"><span class="comment">% a from the</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,129" id="srcline129">129</a></span><span class="line"><span class="comment">% e qual i ty : a ' x = b .</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,130" id="srcline130">130</a></span><span class="line"><span class="comment">% g : i s the gradient (nx1 ) of the QP.</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,131" id="srcline131">131</a></span><span class="line"><span class="comment">% b : i s the r i ght hand si de of the c o nst ra i nt s .</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,132" id="srcline132">132</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,133" id="srcline133">133</a></span><span class="line"><span class="comment">% Output parameters</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,134" id="srcline134">134</a></span><span class="line"><span class="comment">% x : the sol u ti o n</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,135" id="srcline135">135</a></span><span class="line"><span class="comment">% mu : the lagrangian m u l t i p l i e r s</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,136" id="srcline136">136</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,137" id="srcline137">137</a></span><span class="line"><span class="comment">% By : Carsten V\ ¨olcker , s961572 &amp; Esben Lundsager Hansen , s022022 .</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,138" id="srcline138">138</a></span><span class="line"><span class="comment">% Subject : Numerical Methods f or Sequential Quadratic Optimization ,</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,139" id="srcline139">139</a></span><span class="line"><span class="comment">% Master Thesis , IMM, DTU, DK-2800 Lyngby .</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,140" id="srcline140">140</a></span><span class="line"><span class="comment">% Supervisor : John Bagterp Jørgensen , Assistant Pr ofe ssor &amp; Per Grove</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,141" id="srcline141">141</a></span><span class="line"><span class="comment">% Thomsen , Professor .</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,142" id="srcline142">142</a></span><span class="line"><span class="comment">% Date : 08. february 2007.</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,143" id="srcline143">143</a></span><span class="line"><span class="mxinfo " id="T1:U7"><span class="var type1" id="S55T1U517">g</span>=<span class="mxinfo " id="T1:U9">-<span class="var type1" id="S55T1U519">g</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="147,144" id="srcline144">144</a></span><span class="line"><span class="mxinfo " id="T18:U11"><span class="var type1" id="S56T18U522">A</span>=<span class="mxinfo " id="T18:U13"><span class="var type1" id="S56T18U524">A</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="147,145" id="srcline145">145</a></span><span class="line"><span class="mxinfo " id="T3:U15">[ <span class="var type1" id="S58T3U528">n</span> ,<span class="var type1" id="S59T3U529">m</span>] = size (<span class="var type1" id="S56T18U532">A</span>)</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="147,146" id="srcline146">146</a></span><span class="line"><span class="keyword">if</span> ( <span class="mxinfo " id="T11:U19"><span class="var type1" id="S59T3U537">m</span>~=<span class="mxinfo " id="T3:U21">0</span></span> ) <span class="comment">% for si t u a t i o ns where A i s empty</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,147" id="srcline147">147</a></span><span class="line">    [<span class="var type1" id="S61T18U542">Q</span>,<span class="var type1" id="S62T18U543">R</span>] = qr (<span class="var type1" id="S56T18U546">A</span>) ;</span></span>
<span class="srcline"><span class="lineno"><a href="147,148" id="srcline148">148</a></span><span class="line">    <span class="mxinfo " id="T18:U25"><span class="var type1" id="S64T18U549">Q1</span> = <span class="mxinfo " id="T18:U27"><span class="var type1" id="S61T18U551">Q</span>( <span class="mxinfo " id="T30:U29">:</span> , <span class="mxinfo " id="T10:U30"><span class="mxinfo " id="T3:U31">1</span> :<span class="var type1" id="S59T3U555">m</span></span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="147,149" id="srcline149">149</a></span><span class="line">    <span class="mxinfo " id="T18:U33"><span class="var type1" id="S65T18U558">Q2</span> = <span class="mxinfo " id="T18:U35"><span class="var type1" id="S61T18U560">Q</span>( <span class="mxinfo " id="T30:U37">:</span> ,<span class="mxinfo " id="T10:U38"><span class="mxinfo " id="T3:U39"><span class="var type1" id="S59T3U564">m</span>+<span class="mxinfo " id="T3:U41">1</span></span>:<span class="var type1" id="S58T3U566">n</span></span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="147,150" id="srcline150">150</a></span><span class="line">    <span class="mxinfo " id="T18:U43"><span class="var type1" id="S62T18U569">R</span> = <span class="mxinfo " id="T18:U45"><span class="var type1" id="S62T18U571">R</span>( <span class="mxinfo " id="T10:U47"><span class="mxinfo " id="T3:U48">1</span>:<span class="var type1" id="S59T3U574">m</span></span>, <span class="mxinfo " id="T30:U50">:</span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="147,151" id="srcline151">151</a></span><span class="line">    <span class="mxinfo " id="T18:U51"><span class="var type1" id="S66T18U578">py</span> = <span class="mxinfo " id="T18:U53"><span class="mxinfo " id="T18:U54"><span class="var type1" id="S62T18U581">R</span>'</span>\<span class="var type1" id="S57T18U582">b</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="147,152" id="srcline152">152</a></span><span class="line">    <span class="mxinfo " id="T18:U57"><span class="var type1" id="S67T18U585">Q2t</span> = <span class="mxinfo " id="T18:U59"><span class="var type1" id="S65T18U587">Q2</span>'</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="147,153" id="srcline153">153</a></span><span class="line">    <span class="mxinfo " id="T1:U61"><span class="var type1" id="S68T1U590">gz</span> = <span class="mxinfo " id="T1:U63"><span class="var type1" id="S67T18U592">Q2t</span>*(<span class="mxinfo " id="T1:U65"><span class="mxinfo " id="T18:U66"><span class="var type1" id="S54T18U596">G</span>*(<span class="mxinfo " id="T18:U68"><span class="var type1" id="S64T18U599">Q1</span>*<span class="var type1" id="S66T18U600">py</span></span> )</span> + <span class="var type1" id="S55T1U601">g</span></span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="147,154" id="srcline154">154</a></span><span class="line">    <span class="mxinfo " id="T18:U72"><span class="var type1" id="S69T18U604">Gz</span> = <span class="mxinfo " id="T18:U74"><span class="mxinfo " id="T18:U75"><span class="var type1" id="S67T18U607">Q2t</span>*<span class="var type1" id="S54T18U608">G</span></span>*<span class="var type1" id="S65T18U609">Q2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="147,155" id="srcline155">155</a></span><span class="line">    <span class="mxinfo " id="T18:U79"><span class="var type1" id="S70T18U612">L</span> = <span class="mxinfo " id="T18:U81"><span class="mxinfo " id="T18:U82">chol(<span class="var type1" id="S69T18U616">Gz</span>)</span>'</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="147,156" id="srcline156">156</a></span><span class="line">    <span class="mxinfo " id="T1:U84"><span class="var type1" id="S72T1U619">pz</span> = <span class="mxinfo " id="T1:U86"><span class="var type1" id="S70T18U621">L</span>\<span class="mxinfo " id="T1:U88">-<span class="var type1" id="S68T1U623">gz</span></span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="147,157" id="srcline157">157</a></span><span class="line">    <span class="mxinfo " id="T1:U90"><span class="var type1" id="S72T1U626">pz</span> = <span class="mxinfo " id="T1:U92"><span class="mxinfo " id="T18:U93"><span class="var type1" id="S70T18U629">L</span>'</span>\ <span class="var type1" id="S72T1U630">pz</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="147,158" id="srcline158">158</a></span><span class="line">    <span class="mxinfo " id="T1:U96"><span class="var type1" id="S52T1U633">x</span> = <span class="mxinfo " id="T1:U98"><span class="mxinfo " id="T18:U99"><span class="var type1" id="S64T18U636">Q1</span>*<span class="var type1" id="S66T18U637">py</span></span> + <span class="mxinfo " id="T1:U102"><span class="var type1" id="S65T18U639">Q2</span>*<span class="var type1" id="S72T1U640">pz</span></span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="147,159" id="srcline159">159</a></span><span class="line">    <span class="mxinfo " id="T18:U105"><span class="var type1" id="S53T18U643">u</span> = <span class="mxinfo " id="T1:U107"><span class="var type1" id="S62T18U645">R</span>\(<span class="mxinfo " id="T1:U109"><span class="mxinfo " id="T18:U110"><span class="var type1" id="S64T18U649">Q1</span>'</span> * (<span class="mxinfo " id="T1:U112"><span class="mxinfo " id="T1:U113"><span class="var type1" id="S54T18U653">G</span>*<span class="var type1" id="S52T1U654">x</span></span> + <span class="var type1" id="S55T1U655">g</span></span> )</span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="147,160" id="srcline160">160</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,161" id="srcline161">161</a></span><span class="line">    <span class="mxinfo " id="T1:U117"><span class="var type1" id="S52T1U659">x</span> = <span class="mxinfo " id="T1:U119"><span class="mxinfo " id="T18:U120">-<span class="var type1" id="S54T18U662">G</span></span>\<span class="var type1" id="S55T1U663">g</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="147,162" id="srcline162">162</a></span><span class="line">    <span class="mxinfo " id="T18:U123"><span class="var type1" id="S53T18U666">u</span> = <span class="mxinfo " id="T47:U125">[ ]</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="147,163" id="srcline163">163</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="147,164" id="srcline164">164</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
