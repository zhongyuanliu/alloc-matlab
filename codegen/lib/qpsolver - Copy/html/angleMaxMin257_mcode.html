<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="81,451" id="srcline451">451</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="81,452" id="srcline452">452</a></span><span class="line"><span class="comment">%!!!!!!!!!!!!!check if there are bugs</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,453" id="srcline453">453</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S105T3U3254">phi_</span>,<span class="var type1" id="S106T3U3255">phiPlus</span>]=angleMaxMin(<span class="var type1" id="S107T3U3258">angle_start</span>,<span class="var type1" id="S108T3U3259">angle_end</span>,<span class="var type1" id="S109T3U3260">phi</span>,<span class="var type1" id="S110T3U3261">phi1</span>,<span class="var type1" id="S111T3U3262">phi2</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="81,454" id="srcline454">454</a></span><span class="line"><span class="comment">%% up x axis, right y axis, angle starts from x axis, -pi to pi, clockwise</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,455" id="srcline455">455</a></span><span class="line"><span class="comment">% phi: current angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,456" id="srcline456">456</a></span><span class="line"><span class="comment">% phi1 to phi2</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,457" id="srcline457">457</a></span><span class="line"><span class="comment">%!!!!!!!!!!!!!!!!!!!!!watch out for FeasibilityTol</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,458" id="srcline458">458</a></span><span class="line"><span class="mxinfo " id="T3:U8"><span class="var type1" id="S112T3U3265">FeasibilityTol</span> = <span class="mxinfo " id="T3:U10">1e-8</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,459" id="srcline459">459</a></span><span class="line"><span class="mxinfo " id="T3:U11"><span class="var type1" id="S107T3U3269">angle_start</span> = <span class="mxinfo " id="T3:U13"><span class="fcn" id="F258N4:B3271">Pi_toPi</span>(<span class="var type1" id="S107T3U3272">angle_start</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,460" id="srcline460">460</a></span><span class="line"><span class="mxinfo " id="T3:U15"><span class="var type1" id="S108T3U3275">angle_end</span> = <span class="mxinfo " id="T3:U17"><span class="fcn" id="F258N4:B3277">Pi_toPi</span>(<span class="var type1" id="S108T3U3278">angle_end</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,461" id="srcline461">461</a></span><span class="line"><span class="mxinfo " id="T3:U19"><span class="var type1" id="S109T3U3281">phi</span> = <span class="mxinfo " id="T3:U21"><span class="fcn" id="F258N4:B3283">Pi_toPi</span>(<span class="var type1" id="S109T3U3284">phi</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,462" id="srcline462">462</a></span><span class="line"><span class="mxinfo " id="T3:U23"><span class="var type1" id="S110T3U3287">phi1</span> = <span class="mxinfo " id="T3:U25"><span class="fcn" id="F258N4:B3289">Pi_toPi</span>(<span class="var type1" id="S110T3U3290">phi1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,463" id="srcline463">463</a></span><span class="line"><span class="mxinfo " id="T3:U27"><span class="var type1" id="S111T3U3293">phi2</span> = <span class="mxinfo " id="T3:U29"><span class="fcn" id="F258N4:B3295">Pi_toPi</span>(<span class="var type1" id="S111T3U3296">phi2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,464" id="srcline464">464</a></span><span class="line"><span class="mxinfo " id="T3:U31"><span class="var type1" id="S114T3U3299">effective_dist</span> = <span class="mxinfo " id="T3:U33"><span class="fcn" id="F264N7:B3301">angle_dist</span>(<span class="var type1" id="S107T3U3302">angle_start</span>,<span class="var type1" id="S108T3U3303">angle_end</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,465" id="srcline465">465</a></span><span class="line"><span class="mxinfo " id="T3:U36"><span class="var type1" id="S116T3U3306">start_phi1</span> = <span class="mxinfo " id="T3:U38"><span class="fcn" id="F264N7:B3308">angle_dist</span>(<span class="var type1" id="S107T3U3309">angle_start</span>,<span class="var type1" id="S110T3U3310">phi1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,466" id="srcline466">466</a></span><span class="line"><span class="mxinfo " id="T3:U41"><span class="var type1" id="S117T3U3313">phi1_end</span> = <span class="mxinfo " id="T3:U43"><span class="fcn" id="F264N7:B3315">angle_dist</span>(<span class="var type1" id="S110T3U3316">phi1</span>,<span class="var type1" id="S108T3U3317">angle_end</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,467" id="srcline467">467</a></span><span class="line"><span class="mxinfo " id="T3:U46"><span class="var type1" id="S118T3U3320">phi1_phi2</span> = <span class="mxinfo " id="T3:U48"><span class="fcn" id="F264N7:B3322">angle_dist</span>(<span class="var type1" id="S110T3U3323">phi1</span>,<span class="var type1" id="S111T3U3324">phi2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,468" id="srcline468">468</a></span><span class="line"><span class="mxinfo " id="T3:U51"><span class="var type1" id="S119T3U3327">phi1_start</span> = <span class="mxinfo " id="T3:U53"><span class="fcn" id="F264N7:B3329">angle_dist</span>(<span class="var type1" id="S110T3U3330">phi1</span>,<span class="var type1" id="S107T3U3331">angle_start</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,469" id="srcline469">469</a></span><span class="line"><span class="mxinfo " id="T3:U56"><span class="var type1" id="S120T3U3334">phi1_phi</span> = <span class="mxinfo " id="T3:U58"><span class="fcn" id="F264N7:B3336">angle_dist</span>(<span class="var type1" id="S110T3U3337">phi1</span>,<span class="var type1" id="S109T3U3338">phi</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,470" id="srcline470">470</a></span><span class="line"><span class="mxinfo " id="T3:U61"><span class="var type1" id="S121T3U3341">start_phi</span> = <span class="mxinfo " id="T3:U63"><span class="fcn" id="F264N7:B3343">angle_dist</span>(<span class="var type1" id="S107T3U3344">angle_start</span>,<span class="var type1" id="S109T3U3345">phi</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,471" id="srcline471">471</a></span><span class="line"><span class="mxinfo " id="T3:U66"><span class="var type1" id="S122T3U3348">start_phi2</span> = <span class="mxinfo " id="T3:U68"><span class="fcn" id="F264N7:B3350">angle_dist</span>(<span class="var type1" id="S107T3U3351">angle_start</span>,<span class="var type1" id="S111T3U3352">phi2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,472" id="srcline472">472</a></span><span class="line"><span class="mxinfo " id="T3:U71"><span class="var type1" id="S105T3U3355">phi_</span> = <span class="mxinfo " id="T3:U73">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,473" id="srcline473">473</a></span><span class="line"><span class="mxinfo " id="T3:U74"><span class="var type1" id="S106T3U3359">phiPlus</span> = <span class="mxinfo " id="T3:U76">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,474" id="srcline474">474</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T11:U77"><span class="var type1" id="S114T3U3364">effective_dist</span> &gt;= <span class="var type1" id="S116T3U3365">start_phi1</span></span> <span class="comment">%phi1 is at the range from start to end</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,475" id="srcline475">475</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T11:U80"><span class="var type1" id="S117T3U3369">phi1_end</span> &gt;= <span class="var type1" id="S118T3U3370">phi1_phi2</span></span> <span class="comment">%phi2 is at the range from phi1 to end</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,476" id="srcline476">476</a></span><span class="line">        <span class="mxinfo " id="T3:U83"><span class="var type1" id="S105T3U3373">phi_</span> = <span class="var type1" id="S110T3U3374">phi1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,477" id="srcline477">477</a></span><span class="line">        <span class="mxinfo " id="T3:U86"><span class="var type1" id="S106T3U3377">phiPlus</span> = <span class="var type1" id="S111T3U3378">phi2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,478" id="srcline478">478</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo " id="T11:U89"><span class="var type1" id="S118T3U3382">phi1_phi2</span> &gt; <span class="var type1" id="S117T3U3383">phi1_end</span></span> <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,479" id="srcline479">479</a></span><span class="line">            &amp;&amp; <span class="mxinfo " id="T11:U92"><span class="var type1" id="S118T3U3385">phi1_phi2</span> &lt;= <span class="var type1" id="S119T3U3386">phi1_start</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="81,480" id="srcline480">480</a></span><span class="line">        <span class="mxinfo " id="T3:U95"><span class="var type1" id="S105T3U3389">phi_</span> = <span class="var type1" id="S110T3U3390">phi1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,481" id="srcline481">481</a></span><span class="line">        <span class="mxinfo " id="T3:U98"><span class="var type1" id="S106T3U3393">phiPlus</span> = <span class="var type1" id="S108T3U3394">angle_end</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,482" id="srcline482">482</a></span><span class="line">    <span class="keyword">else</span> <span class="comment">%phi2 is at the range from start to phi1</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,483" id="srcline483">483</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T11:U101"><span class="var type1" id="S120T3U3399">phi1_phi</span> &lt;= <span class="var type1" id="S117T3U3400">phi1_end</span></span><span class="comment">%phi is at the range from phi1 to end</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,484" id="srcline484">484</a></span><span class="line">            <span class="mxinfo " id="T3:U104"><span class="var type1" id="S105T3U3403">phi_</span> = <span class="var type1" id="S110T3U3404">phi1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,485" id="srcline485">485</a></span><span class="line">            <span class="mxinfo " id="T3:U107"><span class="var type1" id="S106T3U3407">phiPlus</span> = <span class="var type1" id="S108T3U3408">angle_end</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,486" id="srcline486">486</a></span><span class="line">        <span class="keyword">elseif</span> <span class="mxinfo " id="T11:U110"><span class="var type1" id="S121T3U3411">start_phi</span> &lt;= <span class="var type1" id="S122T3U3412">start_phi2</span></span><span class="comment">%phi is at the range from start to phi2</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,487" id="srcline487">487</a></span><span class="line">            <span class="mxinfo " id="T3:U113"><span class="var type1" id="S105T3U3415">phi_</span> = <span class="var type1" id="S107T3U3416">angle_start</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,488" id="srcline488">488</a></span><span class="line">            <span class="mxinfo " id="T3:U116"><span class="var type1" id="S106T3U3419">phiPlus</span> = <span class="var type1" id="S111T3U3420">phi2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,489" id="srcline489">489</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,490" id="srcline490">490</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="81,491" id="srcline491">491</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,492" id="srcline492">492</a></span><span class="line"><span class="keyword">else</span><span class="comment">%phi1 is at the range from end to start</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,493" id="srcline493">493</a></span><span class="line">    <span class="mxinfo " id="T3:U119"><span class="var type1" id="S105T3U3424">phi_</span> = <span class="var type1" id="S107T3U3425">angle_start</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,494" id="srcline494">494</a></span><span class="line">    <span class="mxinfo " id="T3:U122"><span class="var type1" id="S106T3U3428">phiPlus</span> = <span class="var type1" id="S111T3U3429">phi2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,495" id="srcline495">495</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,496" id="srcline496">496</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="81,497" id="srcline497">497</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="81,498" id="srcline498">498</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="81,499" id="srcline499">499</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="81,500" id="srcline500">500</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,501" id="srcline501">501</a></span><span class="line"></span></span>
</pre>
